import os
from pathlib import Path

import wandb
from omegaconf import OmegaConf

from bim_gw.modules.gw import GlobalWorkspace
from pytorch_lightning import seed_everything

from bim_gw.datasets import load_dataset
from bim_gw.scripts.utils import get_trainer, get_domains
from bim_gw.utils import get_args

checkpoints = [
    {'name': '4272', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4278', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4308', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4314', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4074', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4077', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4089', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4128', 'coef_supervision': 1, 'coef_contrastive': 5, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4191', 'coef_supervision': 1, 'coef_contrastive': 10, 'coef_dcy': 5, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4086', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4122', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4194', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 5, 'coef_cy': 5, 'prop_sup': 0.0001,
     'type': 'attr'},
    {'name': '4273', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4300', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4306', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4366', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4075', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4078', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4114', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4129', 'coef_supervision': 1, 'coef_contrastive': 5, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4210', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4099', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4123', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4147', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 5, 'prop_sup': 0.001,
     'type': 'attr'},
    {'name': '4274', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4286', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4343', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4394', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 5, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4076', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4079', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4103', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4133', 'coef_supervision': 1, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4211', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 10, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4088', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4220', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '4136', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.002,
     'type': 'attr'},
    {'name': '901933', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901957', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '902025', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '902097', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 10, 'coef_cy': 5, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901668', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901672', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901704', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901736', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901832', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 5, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901684', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901860', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901748', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.01,
     'type': 'attr'},
    {'name': '901934', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901938', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '902022', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '902098', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 10, 'coef_cy': 5, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901669', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901677', 'coef_supervision': 1, 'coef_contrastive': 5, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901689', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901865', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901849', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 10, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901701', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901733', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901765', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 5, 'prop_sup': 0.02,
     'type': 'attr'},
    {'name': '901935', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901943', 'coef_supervision': 0, 'coef_contrastive': 5, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '902023', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '902103', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 10, 'coef_cy': 5, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901670', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901674', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901690', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901866', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901850', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 10, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901702', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901734', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901750', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.1,
     'type': 'attr'},
    {'name': '901936', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901952', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '902032', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '902116', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 10, 'coef_cy': 10, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '4412', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 5, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '4414', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '4416', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 5, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901671', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901675', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901691', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901803', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901819', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 5, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901687', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901735', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '901751', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 'attr'},
    {'name': '5628', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5638', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5688', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5848', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 10, 'coef_cy': 10, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5298', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5303', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5373', 'coef_supervision': 1, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5543', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5523', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5358', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5378', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '5598', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 10, 'prop_sup': 0.0001,
     'type': 't'},
    {'name': '6159', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6163', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6207', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6219', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5895', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5903', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5951', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5967', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6079', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5927', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6023', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '6055', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 2, 'prop_sup': 0.0002,
     'type': 't'},
    {'name': '5629', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5634', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5684', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5814', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 1, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5299', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5309', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5369', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5544', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5524', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5359', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5539', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '5599', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 10, 'prop_sup': 0.001,
     'type': 't'},
    {'name': '6160', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6164', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6208', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6220', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5896', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5904', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5948', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6028', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6012', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 10, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5912', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5960', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '6056', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 2, 'prop_sup': 0.002,
     'type': 't'},
    {'name': '5630', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5670', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5805', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5765', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 2, 'coef_cy': 1, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5300', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5305', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5345', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5545', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5525', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5320', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5540', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '5420', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 2, 'prop_sup': 0.01,
     'type': 't'},
    {'name': '6161', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6181', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6201', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6221', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5897', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5901', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5933', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6093', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6077', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5913', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '6089', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 0, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5977', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.02,
     'type': 't'},
    {'name': '5631', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5671', 'coef_supervision': 0, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5681', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5826', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 10, 'coef_cy': 1, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5301', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5306', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5346', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5466', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5526', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 10, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5321', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5461', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '5581', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 10, 'coef_cy': 2, 'prop_sup': 0.1,
     'type': 't'},
    {'name': '6162', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '6174', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '6202', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '6222', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5898', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5902', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5934', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5966', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5998', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 2, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5914', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '6026', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5994', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 2, 'prop_sup': 0.2,
     'type': 't'},
    {'name': '5632', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5677', 'coef_supervision': 0, 'coef_contrastive': 10, 'coef_dcy': 0, 'coef_cy': 10, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5682', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5817', 'coef_supervision': 0, 'coef_contrastive': 1, 'coef_dcy': 10, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5860', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 2, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5862', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5865', 'coef_supervision': 0, 'coef_contrastive': 0, 'coef_dcy': 1, 'coef_cy': 10, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5302', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5307', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 0, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5332', 'coef_supervision': 1, 'coef_contrastive': 2, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5467', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5407', 'coef_supervision': 1, 'coef_contrastive': 1, 'coef_dcy': 1, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5322', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 0, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5462', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 0, 'prop_sup': 1.0,
     'type': 't'},
    {'name': '5482', 'coef_supervision': 1, 'coef_contrastive': 0, 'coef_dcy': 2, 'coef_cy': 1, 'prop_sup': 1.0,
     'type': 't'}]

local_path = Path("/home/benjamin/Projects/bimGW/checkpoints/bimGW")

if __name__ == "__main__":
    args = get_args(debug=int(os.getenv("DEBUG", 0)))
    seed_everything(args.seed)

    k = 1

    for language_type in ['t', 'attr']:
        args.global_workspace.selected_domains = ["v", language_type]

        data = load_dataset(args, args.global_workspace)
        data.prepare_data()
        data.setup(stage="fit")

        for checkpoint in checkpoints:
            run_id = checkpoint['name']
            if int(run_id) < 100_000 and checkpoint['type'] == language_type:
                checkpoint_path = local_path / run_id
                for p in checkpoint_path.iterdir():
                    args.losses.coefs.demi_cycles = checkpoint["coef_dcy"]
                    args.losses.coefs.cycles = checkpoint["coef_cy"]
                    args.losses.coefs.supervision = checkpoint["coef_supervision"]
                    args.losses.coefs.contrastive = checkpoint["coef_contrastive"]
                    args.global_workspace.selected_domains = OmegaConf.create(["v", checkpoint['type']])
                    args.global_workspace.prop_labelled_images = checkpoint['prop_sup']

                    global_workspace = GlobalWorkspace.load_from_checkpoint(str(p),
                                                                            domain_mods=get_domains(args,
                                                                                                    len(data.classes),
                                                                                                    data.img_size),
                                                                            domain_examples=data.domain_examples,
                                                                            strict=False)

                    trainer = get_trainer("train_gw", args, global_workspace,
                                          monitor_loss="val/in_dist/total_loss",
                                          early_stopping_patience=args.global_workspace.early_stopping_patience,
                                          trainer_args={
                                              # "val_check_interval": args.global_workspace.prop_labelled_images
                                          })
                    for logger in trainer.loggers:
                        logger.save_images(True)

                    print(f"Validating model {k} / {len(checkpoints)}")
                    trainer.validate(global_workspace, data)
                    k += 1

                    wandb.finish()
